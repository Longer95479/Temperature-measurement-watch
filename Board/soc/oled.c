#define	OLED_GLOBALS

#include "GLOBAL.h"
#include "oled.h"
#include "delay.h"
#include "oled_font.h"

#include "wheel.h"


//该代码块中的函数对外界不开放
#if 1  		//创建一个可折叠的代码块用于存放IIC操作函数
void IIC_start(void)//传输开始
{
	OLED_SCL_H;
	OLED_SDA_H;
	OLED_SDA_L;
	OLED_SCL_L;
}
void IIC_stop(void)//传输结束
{
	OLED_SCL_L;
	OLED_SDA_L;
	OLED_SCL_H;
	OLED_SDA_H;
}
void IIC_waitack(void)//等待应答
{
	OLED_SCL_H;
	OLED_SCL_L;
}
void IIC_sendbyte(char Byte)//传输一个字节
{
	OLED_SCL_L;
	for(int a = 0;a<8;a++)
	{
		if(Byte&0x80)
		{
			OLED_SDA_H;
		}
		else
		{
			OLED_SDA_L;
		}
		Byte <<= 1;
		OLED_SCL_H;
		OLED_SCL_L;
	}
}
void IIC_writedata(uint8_t data,char identifying)
{
	IIC_start();
	IIC_sendbyte(0x78);
	IIC_waitack();
	if(identifying)
	{
		IIC_sendbyte(0x40);
	}
	else
	{
		IIC_sendbyte(0x00);
	}
	IIC_waitack();
	IIC_sendbyte(data);
	IIC_waitack();
	IIC_stop();
}

#endif
/*

*/
void OLED_init(void)
{
 	GPIO_InitTypeDef GPIO_InitStructure;
 	
 	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);//打开GPIOB的时钟
	#ifdef	VET6
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10|GPIO_Pin_11;
 	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_OD;//开漏输出
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 	GPIO_Init(GPIOB,&GPIO_InitStructure);
	
 	GPIO_SetBits(GPIOB,GPIO_Pin_10|GPIO_Pin_11);//使GPIOB10 11输出高电平
	#endif
	
	#ifdef C8T6
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6|GPIO_Pin_7;
 	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_OD;//开漏输出
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 	GPIO_Init(GPIOB,&GPIO_InitStructure);
	
 	GPIO_SetBits(GPIOB,GPIO_Pin_6|GPIO_Pin_7);//使GPIOB10 11输出高电平
	#endif
	
	delay_init();
	//以下代码与oled通讯= =初始化它
	IIC_writedata(0xAE,OLED_COMMAND);//display off
	IIC_writedata(0x00,OLED_COMMAND);//set low column address
	IIC_writedata(0x10,OLED_COMMAND);//set high column address
	IIC_writedata(0x40,OLED_COMMAND);//set start line address  
	IIC_writedata(0xB0,OLED_COMMAND);//set page address
	IIC_writedata(0x81,OLED_COMMAND);//contract control
	IIC_writedata(0xFF,OLED_COMMAND);//128   
	IIC_writedata(0xA1,OLED_COMMAND);//set segment remap 
	IIC_writedata(0xA6,OLED_COMMAND);//normal / reverse
	IIC_writedata(0xA8,OLED_COMMAND);//set multiplex ratio(1 to 64)
	IIC_writedata(0x3F,OLED_COMMAND);//1/32 duty
	IIC_writedata(0xC8,OLED_COMMAND);//Com scan direction
	IIC_writedata(0xD3,OLED_COMMAND);//set display offset
	IIC_writedata(0x00,OLED_COMMAND);//
	IIC_writedata(0xD5,OLED_COMMAND);//set osc division
	IIC_writedata(0x80,OLED_COMMAND);//
	IIC_writedata(0xD8,OLED_COMMAND);//set area color mode off
	IIC_writedata(0x05,OLED_COMMAND);//
	IIC_writedata(0xD9,OLED_COMMAND);//Set Pre-Charge Period
	IIC_writedata(0xF1,OLED_COMMAND);//
	IIC_writedata(0xDA,OLED_COMMAND);//set com pin configuartion
	IIC_writedata(0x12,OLED_COMMAND);//
	IIC_writedata(0xDB,OLED_COMMAND);//set Vcomh
	IIC_writedata(0x30,OLED_COMMAND);//
	IIC_writedata(0x8D,OLED_COMMAND);//set charge pump enable
	IIC_writedata(0x14,OLED_COMMAND);//
	IIC_writedata(0xAF,OLED_COMMAND);//--turn on oled panel
	OLED_clear();
}

void OLED_clear(void)  
{ 
	for(int i=0;i<8;i++)  
	{  
		IIC_writedata(0xb0+i,OLED_COMMAND);
		IIC_writedata(0x00,OLED_COMMAND);
		IIC_writedata(0x10,OLED_COMMAND);
		for(int n=0;n<128;n++)
		{
			IIC_writedata(0,OLED_DATA);
		}
	}
}
void OLED_setpos(uint8_t x,uint8_t y)
{
	IIC_writedata(0xb0+y,OLED_COMMAND);
	IIC_writedata(((x&0xf0)>>4)|0x10,OLED_COMMAND);
	IIC_writedata((x&0x0f),OLED_COMMAND); 
}
void OLED_show6x8char(uint8_t x,uint8_t y,char character)
{
	character -= ' ';//消除字库中的偏移量
	OLED_setpos(x,y);
	for(int a = 0;a<6;a++)
	{
		IIC_writedata(char6X8[character][a],OLED_DATA);
	}
}

void OLED_show6x8char_inverse(uint8_t x,uint8_t y,char character)
{
	character -= ' ';//消除字库中的偏移量
	OLED_setpos(x,y);
	for(int a = 0;a<6;a++)
	{
		IIC_writedata(~char6X8[character][a],OLED_DATA);
	}
}

void OLED_show8x16char(uint8_t x,uint8_t y,char character)
{
	character -= ' ';//消除字库中的偏移量
	OLED_setpos(x,y);
	for(int a = 0;a<8;a++)
	{
		IIC_writedata(char8X16[character][a],OLED_DATA);
	}
	OLED_setpos(x,y+1);
	for(int a = 0;a<8;a++)
	{
		IIC_writedata(char8X16[character][a+8],OLED_DATA);
	}
}

void OLED_show8x16char_inverse(uint8_t x,uint8_t y,char character)
{
	character -= ' ';//消除字库中的偏移量
	OLED_setpos(x,y);
	for(int a = 0;a<8;a++)
	{
		IIC_writedata(~char8X16[character][a],OLED_DATA);
	}
	OLED_setpos(x,y+1);
	for(int a = 0;a<8;a++)
	{
		IIC_writedata(~char8X16[character][a+8],OLED_DATA);
	}
}

void OLED_show6x8string(uint8_t x,uint8_t y,char* string)
{
	OLED_setpos(x,y);
	int location = 0;
	while(string[location] != '\0')
	{
		for(int a = 0;a<6;a++)
		{
			IIC_writedata(char6X8[string[location]-' '][a],OLED_DATA);
		}
		location++;
	}
}

void OLED_show6x8string_inverse(uint8_t x,uint8_t y,char* string)
{
	OLED_setpos(x,y);
	int location = 0;
	while(string[location] != '\0')
	{
		for(int a = 0;a<6;a++)
		{
			IIC_writedata(~(char6X8[string[location]-' '][a]),OLED_DATA);
		}
		location++;
	}
}

void OLED_show8x16string(uint8_t x,uint8_t y,char* string)
{
	int location = 0;
	OLED_setpos(x,y);
	while(string[location] != '\0')
	{
		for(int a = 0;a<8;a++)
		{
			IIC_writedata(char8X16[string[location]-' '][a],OLED_DATA);
		}
		location++;
	}
	location = 0;
	OLED_setpos(x,y+1);
	while(string[location] != '\0')
	{
		for(int a = 0;a<8;a++)
		{
			IIC_writedata(char8X16[string[location]-' '][a+8],OLED_DATA);
		}
		location++;
	}
}

void OLED_show8x16string_inverse(uint8_t x,uint8_t y,char* string)
{
	int location = 0;
	OLED_setpos(x,y);
	while(string[location] != '\0')
	{
		for(int a = 0;a<8;a++)
		{
			IIC_writedata(~char8X16[string[location]-' '][a],OLED_DATA);
		}
		location++;
	}
	location = 0;
	OLED_setpos(x,y+1);
	while(string[location] != '\0')
	{
		for(int a = 0;a<8;a++)
		{
			IIC_writedata(~char8X16[string[location]-' '][a+8],OLED_DATA);
		}
		location++;
	}
}

void OLED_show6x8number(uint8_t x,uint8_t y,int number)
{
	OLED_setpos(x,y);
	if(number<0)//显示负号并使数字变正
	{
		for(int a = 0;a<6;a++)
		{
			IIC_writedata(char6X8['-'-' '][a],OLED_DATA);
		}
		number = -number;
	}
	else
	{
		for(int a = 0;a<6;a++)//显示空白字符
		{
			IIC_writedata(char6X8[0][a],OLED_DATA);
		}
	}
	//转换数字为字符串
	char num[20];
	num[19] = '\0';
	int a = 18;
	while(1)
	{
		if(!number)//当数字为0时跳出
		{
			break;
		}
		num[a] = number%10 + '0';
		number /= 10;
		a--;
	}
	OLED_show6x8string(x+6,y,num+a+1);
}
void OLED_show8x16number(uint8_t x,uint8_t y,int number)
{
	if(number<0)//显示负号并使数字变正
	{
		OLED_show8x16char(x,y,'-');
		number = -number;
	}
	else
	{
		OLED_show8x16char(x,y,' ');
	}
	//转换数字为字符串
	char num[20];
	num[19] = '\0';
	int a = 18;
	while(1)
	{
		if(!number)//当数字为0时跳出
		{
			break;
		}
		num[a] = number%10 + '0';
		number /= 10;
		a--;
	}
	OLED_show8x16string(x+6,y,num+a+1);
}
void OLED_writedata(uint8_t data)
{
	IIC_writedata(data,OLED_DATA);
}

/**
 * @brief	开启屏幕
 */
void oled_turn_on(void)
{
	IIC_writedata(0x8D,OLED_COMMAND);	//设置电荷泵
	IIC_writedata(0x14,OLED_COMMAND); //开启电荷泵
	IIC_writedata(0xAF,OLED_COMMAND);//--turn on oled panel
}

/**
 * @brief	关闭屏幕
 */
void oled_turn_off(void)
{
	IIC_writedata(0x8D,OLED_COMMAND);	//设置电荷泵
	IIC_writedata(0x10,OLED_COMMAND); //关闭电荷泵
	IIC_writedata(0xAE,OLED_COMMAND);//--turn off oled panel
}

/**
 * @breif	初始化息屏时间
 * @note	单位 s
 */
void rest_screen_time_init(int rst)
{
	rest_screen_time = rst;
}



/**
 * @brief	设置息屏时间
 */
void set_rest_screen_time(void)
{
	int wheel_init_pos, first_equ_init_pos = 1;
	int wheel_pos;
	int item = 1;
	char rest_screen_time_chars[2];
	
	rest_screen_time_chars[0] = '0' + rest_screen_time / 10;
	rest_screen_time_chars[1] = '0' + rest_screen_time % 10;
	
	OLED_show6x8string(0, 0, "Set Rest Screen Time");
	
	OLED_show8x16char(52, 3, rest_screen_time_chars[0]);
	OLED_show8x16char(52 + 8, 3, rest_screen_time_chars[1]);
	OLED_show8x16char(52 + 3*8, 3, 'S');
	
	wheel_init_pos = get_wheel_position(60);
	
	key_1 = 0;		//进入循环之前要把按键标志位置零
	key_2 = 0;
	while (key_1 != 1) {
		switch (item) {
			case 0:
				wheel_pos = get_wheel_position(60);
				if (wheel_pos != wheel_init_pos) {
					rest_screen_time_chars[0] = '0' + wheel_pos / 10;
					rest_screen_time_chars[1] = '0' + wheel_pos % 10;
					
					first_equ_init_pos = 0;
				}	
				else if (!first_equ_init_pos) {
					rest_screen_time_chars[0] = '0' + wheel_pos / 10;
					rest_screen_time_chars[1] = '0' + wheel_pos % 10;
				}	
				
				OLED_show8x16char_inverse(52, 3, rest_screen_time_chars[0]);
				OLED_show8x16char_inverse(52 + 8, 3, rest_screen_time_chars[1]);
				//OLED_show8x16char(33 + 3*8, 3, 'S');
				
				if (key_2 == 1) {
					rest_screen_time = wheel_pos;
					item = 1;
					key_2 = 0;
				}
				break;
				
				
			case 1:
				wheel_pos = get_wheel_position(60);
				if (wheel_pos != wheel_init_pos) {
					rest_screen_time_chars[0] = '0' + rest_screen_time / 10;
					rest_screen_time_chars[1] = '0' + rest_screen_time % 10;
					
					first_equ_init_pos = 0;
				}	
				else if (!first_equ_init_pos) {
					rest_screen_time_chars[0] = '0' + rest_screen_time / 10;
					rest_screen_time_chars[1] = '0' + rest_screen_time % 10;
				}	
				
				OLED_show8x16char(52, 3, rest_screen_time_chars[0]);
				OLED_show8x16char(52 + 8, 3, rest_screen_time_chars[1]);
				//OLED_show8x16char(33 + 2*8, 3, 's');
				
				if (key_2 == 1) {
					item = 0;
					key_2 = 0;
				}
				break;
				
		}
	}
	
	key_1 = 0;
}


static void oled_gram_dot_update(uint8_t x, uint8_t y, uint8_t status)
{
	unsigned char page, bx, temp=0;
	
		if(x > 127 || y > 63) 
			return;
		
		page = y / 8;
		bx = y % 8;
		
		temp = 1<<(bx);
		
		if(status) 
			oled_gram[x][page] |= temp;
		else 
			oled_gram[x][page] &= ~temp;
}

void draw_dot(uint8_t x, uint8_t y, uint8_t status)
{
		unsigned char page, bx, temp=0;
	
		if(x > 127 || y > 63) 
			return;
		
		page = y / 8;
		bx = y % 8;
		
		temp = 1<<(bx);
		
		if(status) 
			oled_gram[x][page] |= temp;
		else 
			oled_gram[x][page] &= ~temp;
		
		
		for(int i=0;i<8;i++) { 
			
			IIC_writedata(0xb0+i,OLED_COMMAND);
			IIC_writedata(0x00,OLED_COMMAND);
			IIC_writedata(0x10,OLED_COMMAND);
			
			for(int n=0;n<128;n++) {
				IIC_writedata(oled_gram[n][i], OLED_DATA);
			}		
		}			
}


void oled_gram_line_update(uint8_t x1, uint8_t y1, uint8_t x2, uint8_t y2)
{
	float k, delta_x, delta_y;
	
	if (x1 > x2) {
		int temp;
		temp = x1;
		x1 = x2;
		x2 = temp;
	}
/*	
	if (y1 > y2) {
		int temp;
		temp = y1;
		y1 = y2;
		y2 = temp;
	}
*/	
	
	if (x1 == x2) {
		if (y2 > y1)
			delta_y = y2 - y1;
		else
			delta_y = y1 - y2;
		
		for (int i = 0; i <= delta_y; i++)
		oled_gram_dot_update(x1, y1 < y2 ? y1 + i : y2 + i, 1);
		
	}
	else {
		delta_x = x2 - x1;
		k = (y2 - y1) / delta_x;
		
		for (int i = 0 ; i <= delta_x; i++) {
			oled_gram_dot_update(x1 + i, (uint8_t)(y1 + k * i), 1);
		}
		
	}
}



void draw_oled_gram(void)
{
	for(int i=0;i<8;i++) { 		
			IIC_writedata(0xb0+i,OLED_COMMAND);
			IIC_writedata(0x00,OLED_COMMAND);
			IIC_writedata(0x10,OLED_COMMAND);
			
			for(int n=0;n<128;n++) {
				IIC_writedata(oled_gram[n][i], OLED_DATA);
			}		
	}
}
	


void draw_line(uint8_t x1, uint8_t y1, uint8_t x2, uint8_t y2)
{
	float k, delta_x, delta_y;
	
	if (x1 > x2) {
		int temp;
		temp = x1;
		x1 = x2;
		x2 = temp;
	}
/*	
	if (y1 > y2) {
		int temp;
		temp = y1;
		y1 = y2;
		y2 = temp;
	}
*/	
	
	if (x1 == x2) {
		if (y2 > y1)
			delta_y = y2 - y1;
		else
			delta_y = y1 - y2;
		
		for (int i = 0; i <= delta_y; i++)
			oled_gram_dot_update(x1, y1 < y2 ? y1 + i : y2 + i, 1);
		
	}
	else {
		delta_x = x2 - x1;
		k = (y2 - y1) / delta_x;
		
		for (int i = 0 ; i <= delta_x; i++) {
			oled_gram_dot_update(x1 + i, (uint8_t)(y1 + k * i), 1);
		}
		
	}
		
	for(int i=0;i<8;i++) { 		
			IIC_writedata(0xb0+i,OLED_COMMAND);
			IIC_writedata(0x00,OLED_COMMAND);
			IIC_writedata(0x10,OLED_COMMAND);
			
			for(int n=0;n<128;n++) {
				IIC_writedata(oled_gram[n][i], OLED_DATA);
			}		
	}
}


void draw_coordinate(int xgrids, int ygrids)
{
	int xcell, ycell;
	
	xcell = 128 / xgrids;
	ycell = 64 / ygrids;
	
	oled_gram_line_update(0, 0, 0, 63);
	oled_gram_line_update(0, 63, 127, 63);
	oled_gram_line_update(0, 0, 3, 3);
	oled_gram_line_update(125, 61, 127, 63);
	for (int i = 0; i < ygrids; i++)
		oled_gram_line_update(0, 63 - i*ycell, 2, 63 - i*ycell);
	for (int i = 0; i < xgrids; i++)
		oled_gram_line_update(i * xcell, 63, i *xcell, 61);
	
	for(int i=0;i<8;i++) { 		
			IIC_writedata(0xb0+i,OLED_COMMAND);
			IIC_writedata(0x00,OLED_COMMAND);
			IIC_writedata(0x10,OLED_COMMAND);
			
			for(int n=0;n<128;n++) {
				IIC_writedata(oled_gram[n][i], OLED_DATA);
			}		
	}
	
	
}


///时间显示传入三个整数分别为时，分秒
void OLED_Time(uint8_t x,uint8_t y,uint8_t z)//时间显示
{
	uint8_t i,j,k;
char c[11][5][20]={
{
{0x00,0x00,0xF0,0xE8,0xD8,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xD8,0xE8,0xF0,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0xEF,0xC7,0x83,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x83,0xC7,0xEF,0x00,0x00},///0
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x1F,0x2F,0x37,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x37,0x2F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xE0,0xF0,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x83,0xC7,0xEF,0x00,0x00},///1
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x0F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0x00,0x08,0x18,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xD8,0xE8,0xF0,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0xE0,0xD0,0xB8,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x3B,0x17,0x0F,0x00,0x00},///2
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x1F,0x2F,0x37,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x30,0x20,0x00,0x00,0x00},
},
{
{0x00,0x00,0x00,0x08,0x18,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xD8,0xE8,0xF0,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},//3
{0x00,0x00,0x00,0x10,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xBB,0xD7,0xEF,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x20,0x30,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x37,0x2F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0xF0,0xE0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xE0,0xF0,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x0F,0x17,0x3B,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xBB,0xD7,0xEF,0x00,0x00},////4
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x0F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0xF0,0xE8,0xD8,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x18,0x08,0x00,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x0F,0x17,0x3B,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xB8,0xD0,0xE0,0x00,0x00},////5
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x20,0x30,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x37,0x2F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0xF0,0xE8,0xD8,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x18,0x08,0x00,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},///6
{0x00,0x00,0xEF,0xD7,0xBB,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xB8,0xD0,0xE0,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x1F,0x2F,0x37,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x37,0x2F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0x00,0x08,0x18,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xD8,0xE8,0xF0,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x83,0xC7,0xEF,0x00,0x00},///7
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x0F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0xF0,0xE8,0xD8,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xD8,0xE8,0xF0,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0xEF,0xD7,0xBB,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xBB,0xD7,0xEF,0x00,0x00},///8
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x1F,0x2F,0x37,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x37,0x2F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0xF0,0xE8,0xD8,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xD8,0xE8,0xF0,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x0F,0x17,0x3B,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0xBB,0xD7,0xEF,0x00,0x00},//9
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00},
{0x00,0x00,0x00,0x20,0x30,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x37,0x2F,0x1F,0x00,0x00},
},
{
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},///空
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
}
};//时间

char d[5][3]=
{
{0x00,0x00,0x00},
{0x38,0x38,0x38},
{0x00,0x00,0x00},
{0x38,0x38,0x38},
{0x00,0x00,0x00}
};//点

///时1位
	if(x/10==0)
	{
		for(i=0;i<5;i++)
		{
			OLED_setpos(0,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[10][i][j],OLED_DATA);
			}
		}	
	}
	else
	{
		for(i=0;i<5;i++)
		{
			OLED_setpos(0,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[x/10][i][j],OLED_DATA);
			}
		}		
	}
	
////时2位
		for(i=0;i<5;i++)
		{
			OLED_setpos(20,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[x%10][i][j],OLED_DATA);
			}
		}
//点
		for(i=0;i<5;i++)
		{
			OLED_setpos(40,2+i);
			for(j=0;j<3;j++)
			{
				IIC_writedata(d[i][j],OLED_DATA);
			}
		}		
		
		//分1位
		for(i=0;i<5;i++)
		{
			OLED_setpos(43,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[y/10][i][j],OLED_DATA);
			}
		}
		///分2位
		for(i=0;i<5;i++)
		{
			OLED_setpos(63,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[y%10][i][j],OLED_DATA);
			}
		}
			///点
		for(i=0;i<5;i++)
		{
			OLED_setpos(83,2+i);
			for(j=0;j<3;j++)
			{
				IIC_writedata(d[i][j],OLED_DATA);
			}
		}
		
		//秒1位
		for(i=0;i<5;i++)
		{
			OLED_setpos(86,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[z/10][i][j],OLED_DATA);
			}
		}
		//秒2位
		for(i=0;i<5;i++)
		{
			OLED_setpos(106,2+i);
			for(j=0;j<20;j++)
			{
				IIC_writedata(c[z%10][i][j],OLED_DATA);
			}
		}

}


//温度显示
//传入一个浮点数中右上显示温度
void OLED_Temperature(float x)
{
	uint8_t i,j;
	int k;
	
		char st[6];
		st[5]='\0';
char t[3][2][16]=
{
{{0x10,0x60,0x02,0x8C,0x00,0x00,0xFE,0x92,0x92,0x92,0x92,0x92,0xFE,0x00,0x00,0x00},
{0x04,0x04,0x7E,0x01,0x40,0x7E,0x42,0x42,0x7E,0x42,0x7E,0x42,0x42,0x7E,0x40,0x00}},
{{0x00,0x00,0xFC,0x24,0x24,0x24,0xFC,0x25,0x26,0x24,0xFC,0x24,0x24,0x24,0x04,0x00},
{0x40,0x30,0x8F,0x80,0x84,0x4C,0x55,0x25,0x25,0x25,0x55,0x4C,0x80,0x80,0x80,0x00}},
{{0x06,0x09,0x09,0xE6,0xF8,0x0C,0x04,0x02,0x02,0x02,0x02,0x02,0x04,0x1E,0x00,0x00},
{0x00,0x00,0x00,0x07,0x1F,0x30,0x20,0x40,0x40,0x40,0x40,0x40,0x20,0x10,0x00,0x00}}
};//汉字    温 度 ：
char s[2][3]={{0x38,0x38,0x38},{0x1C,0x1C,0x1C}};//摄氏度符号
	

	for(i=0;i<2;i++)
	{
		OLED_setpos(20,0+i);
		for(j=0;j<16;j++)
	  {
			IIC_writedata(t[0][i][j],OLED_DATA);
	  }
	}
	for(i=0;i<2;i++)
	{
		OLED_setpos(36,0+i);
		for(j=0;j<16;j++)
	  {
			IIC_writedata(t[1][i][j],OLED_DATA);
	  }
	}
	for(i=0;i<2;i++)
	{
		OLED_setpos(53,0+i);
		for(j=0;j<3;j++)
	  {
			IIC_writedata(s[i][j],OLED_DATA);
	  }
	}
	
	
	if(x>60||x<10)
		x=0;
	x*=100;
	k=(int)x;
	i=4;
	while(k!=0)
	{
		if(i==2)
		{
			st[2]='.';
			--i;
			continue;
		}
		st[i]= k%10 +'0';
		k /=10;
		--i;
	}
	
	OLED_show8x16string(60,0,st);
	for(i=0;i<2;i++)
	{
		OLED_setpos(105,0+i);
		for(j=0;j<16;j++)
	  {
			IIC_writedata(t[2][i][j],OLED_DATA);
	  }
	}
	
}
